---
layout: post-current
title: Project Nectarist [03] 테이블 설계
date: 2023-08-30 14:25:00 +0900
categories: project
---
Project Nectarist [02] 번에서 설계한 화면을 바탕으로<br>
프로젝트에서 사용할 테이블을 설계해봤다.<br>
논리적 설계는 생략했다.<br>
<br>
전체 테이블은 다음과 같다.<br>
<br>
<img src="{{ "/assets/img/project_00003_001.png" }}" style="width: 40rem;"/><br>
<br>
ERD 툴을 뭘 쓸까 하다가 간편하게 dbdiagram.io 사이트를 이용했다.<br>
원래 계획한대로 가벼운 프로젝트에 맞는 가벼운 테이블 구조로 완성되었다.<br>
<br>
테이블을 하나씩 자세히 살펴보겠다.<br>
<br>
<img src="{{ "/assets/img/project_00003_002.png" }}" style="width: 40rem;"/><br>
<br>
NT_COCKTAIL은 칵테일 정보 테이블이다.<br>
고유 인덱스와 칵테일 명, 제조법, 칵테일 섬네일을 칼럼으로 가진다.<br>
섬네일은 서버에 이미지 저장 후 이미지 링크만 db에 저장할 예정이다.<br>
<br>
NT_INGRDNT는 재료 테이블이다.<br>
고유 인덱스와 재료 종류, 재료명을 컬럼으로 가진다.<br>
재료 종류는 칵테일 계산기 등에서 좌측에 재료 아이콘을 다양하게 표시할수 있게 하기위해 집어넣었다. <br>
술/주스/허브 등의 종류를 코드화해서 00,01..등으로 저장할 예정이다.<br>
<br>
NT_COCKTAIL_RECIPE는 칵테일 만드는 재료를 위한 테이블이다.<br>
칵테일과 재료를 1:N으로 매칭하고, 분량(AMT)과 단위(UNIT)을 텍스트로 입력하도록 했다.<br>
차후에 실제 가지고있는 재료의 양에 따라 만들수 있는 칵테일을 계산하도록 고도화 하게 될것을 대비해서,<br>
분량과 단위를 제조법에 모두 집어넣지 않고 별도로 분리했다.<br>
칵테일 계산기는 해당 테이블을 이용해서 만들수 있는 칵테일을 계산하게 될 것이다.<br>
<br>
<img src="{{ "/assets/img/project_00003_003.png" }}" style="width: 40rem;"/><br>
<span class="post-overegg">난 ERD 선정리의 달인이라 원래 선이 저렇게 크로스 되는 경우는 잘 안 만드는데.. dbdiagram에서는 선만 따로 움직이는게 불가능해서 어쩔 수 없었다.</span><br>
<br>
NT_USER테이블은 사용자 테이블이다.<br>
사용자 아이디를 PK로 잡는 대신 별도로 인덱스를 붙였는데,<br>
몇가지 이유가 있다.<br>
<br>
(1) 아주 많은 데이터가 아니고서야 큰 차이는 없겠지만, <br>
대체적으로 integer 조인이 varchar 조인보다 빠르다.<br>
(byte 크기 차이나, varchar 특성이나..)<br>
<br>
(2) 예전에 실제 가입하진 않았지만 시스템에서 표시해야 하는 사람의 데이터를 사용자 테이블에 추가할 일이 있었는데, 그런 경우는 ID가 없다보니.. ID가 PK로 되어있던 테이블에 새 인덱스를 주느랴 고생했던 적이 있다.<br>
<br>
(3) (2)번과 관련된 얘긴데, 특정 사이트에서 카카오 네이버등의 소셜 로그인을 이용해 로그인하면 사용자 명이 vnza@aiwe2345등으로 표시되는걸 볼 수 있었다. <br>
ID 대신 특정 값을 집어넣은 것 같은데, 이런 경우에는 해당 값으로 비밀번호를 찾는 등의 동작은 막아야 할 것이다. <br>
또한 게시판에서 ID가 표시되는 시스템이라면 어떤걸 표시해야 할지도 결정이 필요하다. <br>
로그인 타입을 별도로 추가해서 처리하겠지만, ID가 PK가 되는것보단 인덱스를 따로 붙이는게 훨씬 편할 거라는 생각이 든다.<br>
<br>
위 이유들로 인해 이번에도 편의상 사용자에 인덱스를 별도 부여했다.<br>
그 외에는 사용자 ID와 비밀번호 칼럼을 추가했는데, 비밀번호는 암호화/해시를 거쳐서 일정한 길이로 저장할 것이다. 50의 크기는 해시에 따라 조절될 수 있다.<br>
다음으론 이메일과 닉네임 칼럼을 추가했고, 마지막엔 관리자 여부를 추가했다. 관리자가 Y로 되어있는 사용자에게만 관리자 관련 기능이 표시될 것이다.<br>
<br>
NT_USER_INGRDNT 테이블은 사용자가 현재 가지고 있는 재료를 위한 테이블이다.<br>
NT_COCKTAIL_RECIPE처럼 차후에 기능의 확장을 위해 분량과 단위 칼럼을 미리 추가했다.<br>
<br>
<img src="{{ "/assets/img/project_00003_004.png" }}" style="width: 40rem;"/><br>
<br>
NT_BOARD는 게시글 테이블이다.<br>
NT_BOARD_TYPE은 커뮤니티/칼럼/공지사항 등을 00,01.. 등으로 설정할 생각이다.<br>
제목,내용 칼럼이 있고 NT_BOARD_COCKTAIL은 칵테일 칼럼인데,<br>
해당 글이 어떤 칵테일에 관련된 것인지 태그를 달기 위해 만든 칼럼이다.<br>
NT_COCKTAIL_IDX를 join하여 1,7,10 의 형식으로 저장할 것이다.<br>
그 외 섬네일,등록자,등록시간을 칼럼으로 만들었다.<br>
NT_BOARD_MAIN_YN은 메인 캐러셀 등록 여부이고, NT_BOARD_DELETE_YN은 글 삭제 여부이다.<br> 
실제 DB에서 삭제되는게 아닌 삭제여부만 변경하도록 처리했다.<br>
<br>
이렇게 전체적인 테이블 설정이 끝났으니,<br>
화면과 테이블을 참고해서 개발을 시작해 보려고 한다.